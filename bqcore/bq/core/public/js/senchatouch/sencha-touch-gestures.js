if(typeof ExtTouch==="undefined"){ExtTouch={}}ExtTouch.apply=(function(){for(var key in {valueOf:1}){return function(object,config,defaults){if(defaults){ExtTouch.apply(object,defaults)}if(object&&config&&typeof config==="object"){for(var key in config){object[key]=config[key]}}return object}}return function(object,config,defaults){if(defaults){ExtTouch.apply(object,defaults)}if(object&&config&&typeof config==="object"){for(var key in config){object[key]=config[key]}if(config.toString!==Object.prototype.toString){object.toString=config.toString}if(config.valueOf!==Object.prototype.valueOf){object.valueOf=config.valueOf}}return object}})();ExtTouch.apply(ExtTouch,{platformVersion:"1.0",platformVersionDetail:{major:1,minor:0,patch:3},userAgent:navigator.userAgent.toLowerCase(),cache:{},idSeed:1000,BLANK_IMAGE_URL:"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",isStrict:document.compatMode=="CSS1Compat",windowId:"ExtTouch-window",documentId:"ExtTouch-document",emptyFn:function(){},isSecure:/^https/i.test(window.location.protocol),isReady:false,enableGarbageCollector:true,enableListenerCollection:true,applyIf:function(object,config){var property,undefined;if(object){for(property in config){if(object[property]===undefined){object[property]=config[property]}}}return object},repaint:function(){var mask=ExtTouch.getBody().createChild({cls:"x-mask x-mask-transparent"});setTimeout(function(){mask.remove()},0)},id:function(el,prefix){el=ExtTouch.getDom(el)||{};if(el===document){el.id=this.documentId}else{if(el===window){el.id=this.windowId}}el.id=el.id||((prefix||"ExtTouch-gen")+(++ExtTouch.idSeed));return el.id},ExtTouchend:function(){var inlineOverrides=function(o){for(var m in o){if(!o.hasOwnProperty(m)){continue}this[m]=o[m]}};var objectConstructor=Object.prototype.constructor;return function(subclass,superclass,overrides){if(ExtTouch.isObject(superclass)){overrides=superclass;superclass=subclass;subclass=overrides.constructor!=objectConstructor?overrides.constructor:function(){superclass.apply(this,arguments)}}if(!superclass){throw"Attempting to ExtTouchend from a class which has not been loaded on the page."}var F=function(){},subclassProto,superclassProto=superclass.prototype;F.prototype=superclassProto;subclassProto=subclass.prototype=new F();subclassProto.constructor=subclass;subclass.superclass=superclassProto;if(superclassProto.constructor==objectConstructor){superclassProto.constructor=superclass}subclass.override=function(overrides){ExtTouch.override(subclass,overrides)};subclassProto.superclass=subclassProto.supr=(function(){return superclassProto});subclassProto.override=inlineOverrides;subclassProto.proto=subclassProto;subclass.override(overrides);subclass.ExtTouchend=function(o){return ExtTouch.ExtTouchend(subclass,o)};return subclass}}(),override:function(origclass,overrides){ExtTouch.apply(origclass.prototype,overrides)},namespace:function(){var ln=arguments.length,i,value,split,x,xln,parts,object;for(i=0;i<ln;i++){value=arguments[i];parts=value.split(".");if(window.ExtTouch){object=window[parts[0]]=Object(window[parts[0]])}else{object=arguments.callee.caller.arguments[0]}for(x=1,xln=parts.length;x<xln;x++){object=object[parts[x]]=Object(object[parts[x]])}}return object},urlEncode:function(o,pre){var empty,buf=[],e=encodeURIComponent;ExtTouch.iterate(o,function(key,item){empty=ExtTouch.isEmpty(item);ExtTouch.each(empty?key:item,function(val){buf.push("&",e(key),"=",(!ExtTouch.isEmpty(val)&&(val!=key||!empty))?(ExtTouch.isDate(val)?ExtTouch.encode(val).replace(/"/g,""):e(val)):"")})});if(!pre){buf.shift();pre=""}return pre+buf.join("")},urlDecode:function(string,overwrite){if(ExtTouch.isEmpty(string)){return{}}var obj={},pairs=string.split("&"),d=decodeURIComponent,name,value;ExtTouch.each(pairs,function(pair){pair=pair.split("=");name=d(pair[0]);value=d(pair[1]);obj[name]=overwrite||!obj[name]?value:[].concat(obj[name]).concat(value)});return obj},htmlEncode:function(value){return ExtTouch.util.Format.htmlEncode(value)},htmlDecode:function(value){return ExtTouch.util.Format.htmlDecode(value)},urlAppend:function(url,s){if(!ExtTouch.isEmpty(s)){return url+(url.indexOf("?")===-1?"?":"&")+s}return url},toArray:function(array,start,end){return Array.prototype.slice.call(array,start||0,end||array.length)},each:function(array,fn,scope){if(ExtTouch.isEmpty(array,true)){return 0}if(!ExtTouch.isIterable(array)||ExtTouch.isPrimitive(array)){array=[array]}for(var i=0,len=array.length;i<len;i++){if(fn.call(scope||array[i],array[i],i,array)===false){return i}}return true},iterate:function(obj,fn,scope){if(ExtTouch.isEmpty(obj)){return}if(ExtTouch.isIterable(obj)){ExtTouch.each(obj,fn,scope);return}else{if(ExtTouch.isObject(obj)){for(var prop in obj){if(obj.hasOwnProperty(prop)){if(fn.call(scope||obj,prop,obj[prop],obj)===false){return}}}}}},pluck:function(arr,prop){var ret=[];ExtTouch.each(arr,function(v){ret.push(v[prop])});return ret},getBody:function(){return ExtTouch.get(document.body||false)},getHead:function(){var head;return function(){if(head==undefined){head=ExtTouch.get(DOC.getElementsByTagName("head")[0])}return head}}(),getDoc:function(){return ExtTouch.get(document)},getCmp:function(id){return ExtTouch.ComponentMgr.get(id)},getOrientation:function(){return window.innerHeight>window.innerWidth?"portrait":"landscape"},isIterable:function(v){if(!v){return false}if(ExtTouch.isArray(v)||v.callee){return true}if(/NodeList|HTMLCollection/.test(Object.prototype.toString.call(v))){return true}return((typeof v.nExtTouchNode!="undefined"||v.item)&&ExtTouch.isNumber(v.length))||false},num:function(v,defaultValue){v=Number(ExtTouch.isEmpty(v)||ExtTouch.isArray(v)||typeof v=="boolean"||(typeof v=="string"&&ExtTouch.util.Format.trim(v).length==0)?NaN:v);return isNaN(v)?defaultValue:v},isEmpty:function(value,allowBlank){var isNull=value==null,emptyArray=(ExtTouch.isArray(value)&&!value.length),blankAllowed=!allowBlank?value==="":false;return isNull||emptyArray||blankAllowed},isArray:function(v){return Object.prototype.toString.apply(v)==="[object Array]"},isDate:function(v){return Object.prototype.toString.apply(v)==="[object Date]"},isObject:function(v){return !!v&&!v.tagName&&Object.prototype.toString.call(v)==="[object Object]"},isPrimitive:function(v){return ExtTouch.isString(v)||ExtTouch.isNumber(v)||ExtTouch.isBoolean(v)},isFunction:function(v){return Object.prototype.toString.apply(v)==="[object Function]"},isNumber:function(v){return Object.prototype.toString.apply(v)==="[object Number]"&&isFinite(v)},isString:function(v){return typeof v==="string"},isBoolean:function(v){return Object.prototype.toString.apply(v)==="[object Boolean]"},isElement:function(v){return v?!!v.tagName:false},isDefined:function(v){return typeof v!=="undefined"},destroy:function(){var ln=arguments.length,i,arg;for(i=0;i<ln;i++){arg=arguments[i];if(arg){if(ExtTouch.isArray(arg)){this.destroy.apply(this,arg)}else{if(ExtTouch.isFunction(arg.destroy)){arg.destroy()}else{if(arg.dom){arg.remove()}}}}}}});ExtTouch.SSL_SECURE_URL=ExtTouch.isSecure&&"about:blank";ExtTouch.ns=ExtTouch.namespace;ExtTouch.ns("ExtTouch.util","ExtTouch.data","ExtTouch.list","ExtTouch.form","ExtTouch.menu","ExtTouch.state","ExtTouch.layout","ExtTouch.app","ExtTouch.ux","ExtTouch.plugins","ExtTouch.direct","ExtTouch.lib","ExtTouch.gesture");ExtTouch.onReady=function(){};ExtTouch.applyIf(Array.prototype,{indexOf:function(o,from){var len=this.length;from=from||0;from+=(from<0)?len:0;for(;from<len;++from){if(this[from]===o){return from}}return -1},remove:function(o){var index=this.indexOf(o);if(index!=-1){this.splice(index,1)}return this},contains:function(o){return this.indexOf(o)!==-1}});(function(){var El=ExtTouch.Element=ExtTouch.ExtTouchend(Object,{defaultUnit:"px",constructor:function(element,forceNew){var dom=typeof element=="string"?document.getElementById(element):element,id;if(!dom){return null}id=dom.id;if(!forceNew&&id&&ExtTouch.cache[id]){return ExtTouch.cache[id].el}this.dom=dom;this.id=id||ExtTouch.id(dom);return this},set:function(o,useSet){var el=this.dom,attr,value;for(attr in o){if(o.hasOwnProperty(attr)){value=o[attr];if(attr=="style"){this.applyStyles(value)}else{if(attr=="cls"){el.className=value}else{if(useSet!==false){el.setAttribute(attr,value)}else{el[attr]=value}}}}}return this},is:function(simpleSelector){return ExtTouch.DomQuery.is(this.dom,simpleSelector)},getValue:function(asNumber){var val=this.dom.value;return asNumber?parseInt(val,10):val},addListener:function(eventName,fn,scope,options){ExtTouch.EventManager.on(this.dom,eventName,fn,scope||this,options);return this},removeListener:function(eventName,fn,scope){ExtTouch.EventManager.un(this.dom,eventName,fn,scope);return this},removeAllListeners:function(){ExtTouch.EventManager.removeAll(this.dom);return this},purgeAllListeners:function(){ExtTouch.EventManager.purgeElement(this,true);return this},remove:function(){var me=this,dom=me.dom;if(dom){delete me.dom;ExtTouch.removeNode(dom)}},isAncestor:function(c){var p=this.dom;c=ExtTouch.getDom(c);if(p&&c){return p.contains(c)}return false},isDescendent:function(p){return ExtTouch.fly(p,"_internal").isAncestor(this)},contains:function(el){return !el?false:this.isAncestor(el)},getAttribute:function(name,ns){var d=this.dom;return d.getAttributeNS(ns,name)||d.getAttribute(ns+":"+name)||d.getAttribute(name)||d[name]},setHTML:function(html){if(this.dom){this.dom.innerHTML=html}return this},getHTML:function(){return this.dom?this.dom.innerHTML:""},hide:function(){this.setVisible(false);return this},show:function(){this.setVisible(true);return this},setVisible:function(visible,animate){var me=this,dom=me.dom,mode=this.getVisibilityMode();switch(mode){case El.VISIBILITY:this.removeCls(["x-hidden-display","x-hidden-offsets"]);this[visible?"removeCls":"addCls"]("x-hidden-visibility");break;case El.DISPLAY:this.removeCls(["x-hidden-visibility","x-hidden-offsets"]);this[visible?"removeCls":"addCls"]("x-hidden-display");break;case El.OFFSETS:this.removeCls(["x-hidden-visibility","x-hidden-display"]);this[visible?"removeCls":"addCls"]("x-hidden-offsets");break}return me},getVisibilityMode:function(){var dom=this.dom,mode=El.data(dom,"visibilityMode");if(mode===undefined){El.data(dom,"visibilityMode",mode=El.DISPLAY)}return mode},setVisibilityMode:function(mode){El.data(this.dom,"visibilityMode",mode);return this}});var Elp=El.prototype;El.VISIBILITY=1;El.DISPLAY=2;El.OFFSETS=3;El.addMethods=function(o){ExtTouch.apply(Elp,o)};Elp.on=Elp.addListener;Elp.un=Elp.removeListener;Elp.update=Elp.setHTML;El.get=function(el){var ExtTouchEl,dom,id;if(!el){return null}if(typeof el=="string"){if(!(dom=document.getElementById(el))){return null}if(ExtTouch.cache[el]&&ExtTouch.cache[el].el){ExtTouchEl=ExtTouch.cache[el].el;ExtTouchEl.dom=dom}else{ExtTouchEl=El.addToCache(new El(dom))}return ExtTouchEl}else{if(el.tagName){if(!(id=el.id)){id=ExtTouch.id(el)}if(ExtTouch.cache[id]&&ExtTouch.cache[id].el){ExtTouchEl=ExtTouch.cache[id].el;ExtTouchEl.dom=el}else{ExtTouchEl=El.addToCache(new El(el))}return ExtTouchEl}else{if(el instanceof El){if(el!=El.docEl){el.dom=document.getElementById(el.id)||el.dom}return el}else{if(el.isComposite){return el}else{if(ExtTouch.isArray(el)){return El.select(el)}else{if(el==document){if(!El.docEl){var F=function(){};F.prototype=Elp;El.docEl=new F();El.docEl.dom=document;El.docEl.id=ExtTouch.id(document)}return El.docEl}}}}}}return null};El.addToCache=function(el,id){id=id||el.id;ExtTouch.cache[id]={el:el,data:{},events:{}};return el};El.data=function(el,key,value){el=El.get(el);if(!el){return null}var c=ExtTouch.cache[el.id].data;if(arguments.length==2){return c[key]}else{return(c[key]=value)}};El.garbageCollect=function(){if(!ExtTouch.enableGarbageCollector){clearInterval(El.collectorThreadId)}else{var id,dom,EC=ExtTouch.cache;for(id in EC){if(!EC.hasOwnProperty(id)){continue}if(EC[id].skipGarbageCollection){continue}dom=EC[id].el.dom;if(!dom||!dom.parentNode||(!dom.offsetParent&&!document.getElementById(id))){if(ExtTouch.enableListenerCollection){ExtTouch.EventManager.removeAll(dom)}delete EC[id]}}}};El.Flyweight=function(dom){this.dom=dom};var F=function(){};F.prototype=Elp;El.Flyweight.prototype=new F;El.Flyweight.prototype.isFlyweight=true;El._flyweights={};El.fly=function(el,named){var ret=null;named=named||"_global";el=ExtTouch.getDom(el);if(el){(El._flyweights[named]=El._flyweights[named]||new El.Flyweight()).dom=el;ret=El._flyweights[named]}return ret};ExtTouch.get=El.get;ExtTouch.fly=El.fly})();(function(){ExtTouch.Element.classReCache={};var El=ExtTouch.Element,view=document.defaultView;El.addMethods({marginRightRe:/marginRight/i,trimRe:/^\s+|\s+$/g,spacesRe:/\s+/,getStyle:function(prop){},})})();ExtTouch.is={init:function(navigator){var me=this,platforms=me.platforms,ln=platforms.length,i,platform;navigator=navigator||window.navigator;for(i=0;i<ln;i++){platform=platforms[i];me[platform.identity]=platform.regex.test(navigator[platform.property])}me.Desktop=me.Mac||me.Windows||(me.Linux&&!me.Android);me.iOS=me.iPhone||me.iPad||me.iPod;me.Standalone=!!navigator.standalone;i=me.Android&&(/Android\s(\d+\.\d+)/.exec(navigator.userAgent));if(i){me.AndroidVersion=i[1];me.AndroidMajorVersion=parseInt(i[1],10)}me.Tablet=me.iPad||(me.Android&&me.AndroidMajorVersion===3);me.Phone=!me.Desktop&&!me.Tablet;me.MultiTouch=!me.Blackberry&&!me.Desktop&&!(me.Android&&me.AndroidVersion<3)},platforms:[{property:"platform",regex:/iPhone/i,identity:"iPhone"},{property:"platform",regex:/iPod/i,identity:"iPod"},{property:"userAgent",regex:/iPad/i,identity:"iPad"},{property:"userAgent",regex:/Blackberry/i,identity:"Blackberry"},{property:"userAgent",regex:/Android/i,identity:"Android"},{property:"platform",regex:/Mac/i,identity:"Mac"},{property:"platform",regex:/Win/i,identity:"Windows"},{property:"platform",regex:/Linux/i,identity:"Linux"}]};ExtTouch.is.init();ExtTouch.supports={init:function(){var doc=document,div=doc.createElement("div"),tests=this.tests,ln=tests.length,i,test;div.innerHTML=['<div style="height:30px;width:50px;">','<div style="height:20px;width:20px;"></div>',"</div>",'<div style="float:left; background-color:transparent;"></div>'].join("");doc.body.appendChild(div);for(i=0;i<ln;i++){test=tests[i];this[test.identity]=test.fn.call(this,doc,div)}doc.body.removeChild(div)},OrientationChange:((typeof window.orientation!="undefined")&&("onorientationchange" in window)),DeviceMotion:("ondevicemotion" in window),Touch:("ontouchstart" in window)&&(!ExtTouch.is.Desktop),tests:[{identity:"Transitions",fn:function(doc,div){var prefix=["webkit","Moz","o","ms","khtml"],TE="TransitionEnd",transitionEndName=[prefix[0]+TE,"transitionend",prefix[2]+TE,prefix[3]+TE,prefix[4]+TE],ln=prefix.length,i=0,out=false;div=ExtTouch.get(div);for(;i<ln;i++){if(div.getStyle(prefix[i]+"TransitionProperty")){ExtTouch.supports.CSS3Prefix=prefix[i];ExtTouch.supports.CSS3TransitionEnd=transitionEndName[i];out=true;break}}return out}},{identity:"RightMargin",fn:function(doc,div,view){view=doc.defaultView;return !(view&&view.getComputedStyle(div.firstChild.firstChild,null).marginRight!="0px")}},{identity:"TransparentColor",fn:function(doc,div,view){view=doc.defaultView;return !(view&&view.getComputedStyle(div.lastChild,null).backgroundColor!="transparent")}},{identity:"SVG",fn:function(doc){return !!doc.createElementNS&&!!doc.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}},{identity:"Canvas",fn:function(doc){return !!doc.createElement("canvas").getContExtTouch}},{identity:"VML",fn:function(doc){var d=doc.createElement("div");d.innerHTML="<!--[if vml]><br><br><![endif]-->";return(d.childNodes.length==2)}},{identity:"Float",fn:function(doc,div){return !!div.lastChild.style.cssFloat}},{identity:"AudioTag",fn:function(doc){return !!doc.createElement("audio").canPlayType}},{identity:"History",fn:function(){return !!(window.history&&history.pushState)}},{identity:"CSS3DTransform",fn:function(){return(typeof WebKitCSSMatrix!="undefined"&&new WebKitCSSMatrix().hasOwnProperty("m41"))}},{identity:"CSS3LinearGradient",fn:function(doc,div){var property="background-image:",webkit="-webkit-gradient(linear, left top, right bottom, from(black), to(white))",w3c="linear-gradient(left top, black, white)",moz="-moz-"+w3c,options=[property+webkit,property+w3c,property+moz];div.style.cssTExtTouch=options.join(";");return(""+div.style.backgroundImage).indexOf("gradient")!==-1}},{identity:"CSS3BorderRadius",fn:function(doc,div){var domPrefixes=["borderRadius","BorderRadius","MozBorderRadius","WebkitBorderRadius","OBorderRadius","KhtmlBorderRadius"],pass=false,i;for(i=0;i<domPrefixes.length;i++){if(document.body.style[domPrefixes[i]]!==undefined){return pass=true}}return pass}},{identity:"GeoLocation",fn:function(){return(typeof navigator!="undefined"&&typeof navigator.geolocation!="undefined")||(typeof google!="undefined"&&typeof google.gears!="undefined")}}]};ExtTouch.apply(ExtTouch,{version:"1.1.1",versionDetail:{major:1,minor:1,patch:1},setup:function(config){if(config&&typeof config=="object"){if(config.addMetaTags!==false){this.addMetaTags(config)}if(ExtTouch.isFunction(config.onReady)){var me=this;ExtTouch.onReady(function(){var args=arguments;if(config.fullscreen!==false){ExtTouch.Viewport.init(function(){config.onReady.apply(me,args)})}else{config.onReady.apply(this,args)}},config.scope)}}},getDom:function(el){if(!el||!document){return null}return el.dom?el.dom:(typeof el=="string"?document.getElementById(el):el)},removeNode:function(node){if(node&&node.parentNode&&node.tagName!="BODY"){ExtTouch.EventManager.removeAll(node);node.parentNode.removeChild(node);delete ExtTouch.cache[node.id]}},addMetaTags:function(config){if(!ExtTouch.isObject(config)){return}var head=ExtTouch.get(document.getElementsByTagName("head")[0]),tag,precomposed;if(!ExtTouch.is.Desktop){tag=ExtTouch.get(document.createElement("meta"));tag.set({name:"viewport",content:"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0;"});head.appendChild(tag)}if(ExtTouch.is.iOS){if(config.fullscreen!==false){tag=ExtTouch.get(document.createElement("meta"));tag.set({name:"apple-mobile-web-app-capable",content:"yes"});head.appendChild(tag);if(ExtTouch.isString(config.statusBarStyle)){tag=ExtTouch.get(document.createElement("meta"));tag.set({name:"apple-mobile-web-app-status-bar-style",content:config.statusBarStyle});head.appendChild(tag)}}if(config.tabletStartupScreen&&ExtTouch.is.iPad){tag=ExtTouch.get(document.createElement("link"));tag.set({rel:"apple-touch-startup-image",href:config.tabletStartupScreen});head.appendChild(tag)}if(config.phoneStartupScreen&&!ExtTouch.is.iPad){tag=ExtTouch.get(document.createElement("link"));tag.set({rel:"apple-touch-startup-image",href:config.phoneStartupScreen});head.appendChild(tag)}if(config.icon){config.phoneIcon=config.tabletIcon=config.icon}precomposed=(config.glossOnIcon===false)?"-precomposed":"";if(ExtTouch.is.iPad&&ExtTouch.isString(config.tabletIcon)){tag=ExtTouch.get(document.createElement("link"));tag.set({rel:"apple-touch-icon"+precomposed,href:config.tabletIcon});head.appendChild(tag)}else{if(!ExtTouch.is.iPad&&ExtTouch.isString(config.phoneIcon)){tag=ExtTouch.get(document.createElement("link"));tag.set({rel:"apple-touch-icon"+precomposed,href:config.phoneIcon});head.appendChild(tag)}}}}});(function(){var initExtTouch=function(){var bd=ExtTouch.getBody(),cls=[];if(!bd){return false}var Is=ExtTouch.is;if(Is.Phone){cls.push("x-phone")}else{if(Is.Tablet){cls.push("x-tablet")}else{if(Is.Desktop){cls.push("x-desktop")}}}if(Is.iPad){cls.push("x-ipad")}if(Is.iOS){cls.push("x-ios")}if(Is.Android){cls.push("x-android","x-android-"+Is.AndroidMajorVersion)}if(Is.Blackberry){cls.push("x-bb")}if(Is.Standalone){cls.push("x-standalone")}if(cls.length){bd.addCls(cls)}return true};if(!initExtTouch()){ExtTouch.onReady(initExtTouch)}})();ExtTouch.util.Observable=ExtTouch.ExtTouchend(Object,{isObservable:true,constructor:function(config){var me=this;ExtTouch.apply(me,config);if(me.listeners){me.on(me.listeners);delete me.listeners}me.events=me.events||{};if(this.bubbleEvents){this.enableBubble(this.bubbleEvents)}},eventOptionsRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate|element|vertical|horizontal)$/,addManagedListener:function(item,ename,fn,scope,options){var me=this,managedListeners=me.managedListeners=me.managedListeners||[],config;if(ExtTouch.isObject(ename)){options=ename;for(ename in options){if(!options.hasOwnProperty(ename)){continue}config=options[ename];if(!me.eventOptionsRe.test(ename)){me.addManagedListener(item,ename,config.fn||config,config.scope||options.scope,config.fn?config:options)}}}else{managedListeners.push({item:item,ename:ename,fn:fn,scope:scope,options:options});item.on(ename,fn,scope,options)}},removeManagedListener:function(item,ename,fn,scope){var me=this,o,config,managedListeners,managedListener,length,i;if(ExtTouch.isObject(ename)){o=ename;for(ename in o){if(!o.hasOwnProperty(ename)){continue}config=o[ename];if(!me.eventOptionsRe.test(ename)){me.removeManagedListener(item,ename,config.fn||config,config.scope||o.scope)}}}managedListeners=this.managedListeners?this.managedListeners.slice():[];length=managedListeners.length;for(i=0;i<length;i++){managedListener=managedListeners[i];if(managedListener.item===item&&managedListener.ename===ename&&(!fn||managedListener.fn===fn)&&(!scope||managedListener.scope===scope)){this.managedListeners.remove(managedListener);item.un(managedListener.ename,managedListener.fn,managedListener.scope)}}},fireEvent:function(){var me=this,a=ExtTouch.toArray(arguments),ename=a[0].toLowerCase(),ret=true,ev=me.events[ename],queue=me.eventQueue,parent;if(me.eventsSuspended===true){if(queue){queue.push(a)}return false}else{if(ev&&ExtTouch.isObject(ev)&&ev.bubble){if(ev.fire.apply(ev,a.slice(1))===false){return false}parent=me.getBubbleTarget&&me.getBubbleTarget();if(parent&&parent.isObservable){if(!parent.events[ename]||!ExtTouch.isObject(parent.events[ename])||!parent.events[ename].bubble){parent.enableBubble(ename)}return parent.fireEvent.apply(parent,a)}}else{if(ev&&ExtTouch.isObject(ev)){a.shift();ret=ev.fire.apply(ev,a)}}}return ret},addListener:function(ename,fn,scope,o){var me=this,config,ev;if(ExtTouch.isObject(ename)){o=ename;for(ename in o){if(!o.hasOwnProperty(ename)){continue}config=o[ename];if(!me.eventOptionsRe.test(ename)){me.addListener(ename,config.fn||config,config.scope||o.scope,config.fn?config:o)}}}else{ename=ename.toLowerCase();me.events[ename]=me.events[ename]||true;ev=me.events[ename]||true;if(ExtTouch.isBoolean(ev)){me.events[ename]=ev=new ExtTouch.util.Event(me,ename)}ev.addListener(fn,scope,ExtTouch.isObject(o)?o:{})}},removeListener:function(ename,fn,scope){var me=this,config,ev;if(ExtTouch.isObject(ename)){var o=ename;for(ename in o){if(!o.hasOwnProperty(ename)){continue}config=o[ename];if(!me.eventOptionsRe.test(ename)){me.removeListener(ename,config.fn||config,config.scope||o.scope)}}}else{ename=ename.toLowerCase();ev=me.events[ename];if(ev.isEvent){ev.removeListener(fn,scope)}}},clearListeners:function(){var events=this.events,ev,key;for(key in events){if(!events.hasOwnProperty(key)){continue}ev=events[key];if(ev.isEvent){ev.clearListeners()}}this.clearManagedListeners()},purgeListeners:function(){console.warn("MixedCollection: purgeListeners has been deprecated. Please use clearListeners.");return this.clearListeners.apply(this,arguments)},clearManagedListeners:function(){var managedListeners=this.managedListeners||[],ln=managedListeners.length,i,managedListener;for(i=0;i<ln;i++){managedListener=managedListeners[i];managedListener.item.un(managedListener.ename,managedListener.fn,managedListener.scope)}this.managedListener=[]},purgeManagedListeners:function(){console.warn("MixedCollection: purgeManagedListeners has been deprecated. Please use clearManagedListeners.");return this.clearManagedListeners.apply(this,arguments)},addEvents:function(o){var me=this;me.events=me.events||{};if(ExtTouch.isString(o)){var a=arguments,i=a.length;while(i--){me.events[a[i]]=me.events[a[i]]||true}}else{ExtTouch.applyIf(me.events,o)}},hasListener:function(ename){var e=this.events[ename];return e.isEvent===true&&e.listeners.length>0},suspendEvents:function(queueSuspended){this.eventsSuspended=true;if(queueSuspended&&!this.eventQueue){this.eventQueue=[]}},resumeEvents:function(){var me=this,queued=me.eventQueue||[];me.eventsSuspended=false;delete me.eventQueue;ExtTouch.each(queued,function(e){me.fireEvent.apply(me,e)})},relayEvents:function(origin,events,prefix){prefix=prefix||"";var me=this,len=events.length,i,ename;function createHandler(ename){return function(){return me.fireEvent.apply(me,[prefix+ename].concat(Array.prototype.slice.call(arguments,0,-1)))}}for(i=0,len=events.length;i<len;i++){ename=events[i].substr(prefix.length);me.events[ename]=me.events[ename]||true;origin.on(ename,createHandler(ename),me)}},enableBubble:function(events){var me=this;if(!ExtTouch.isEmpty(events)){events=ExtTouch.isArray(events)?events:ExtTouch.toArray(arguments);ExtTouch.each(events,function(ename){ename=ename.toLowerCase();var ce=me.events[ename]||true;if(ExtTouch.isBoolean(ce)){ce=new ExtTouch.util.Event(me,ename);me.events[ename]=ce}ce.bubble=true})}}});ExtTouch.override(ExtTouch.util.Observable,{on:ExtTouch.util.Observable.prototype.addListener,un:ExtTouch.util.Observable.prototype.removeListener,mon:ExtTouch.util.Observable.prototype.addManagedListener,mun:ExtTouch.util.Observable.prototype.removeManagedListener});ExtTouch.util.Observable.releaseCapture=function(o){o.fireEvent=ExtTouch.util.Observable.prototype.fireEvent};ExtTouch.util.Observable.capture=function(o,fn,scope){o.fireEvent=ExtTouch.createInterceptor(o.fireEvent,fn,scope)};ExtTouch.util.Observable.observe=function(cls,listeners){if(cls){if(!cls.isObservable){ExtTouch.applyIf(cls,new ExtTouch.util.Observable());ExtTouch.util.Observable.capture(cls.prototype,cls.fireEvent,cls)}if(typeof listeners=="object"){cls.on(listeners)}return cls}};ExtTouch.util.Observable.observeClass=ExtTouch.util.Observable.observe;ExtTouch.util.Event=ExtTouch.ExtTouchend(Object,(function(){function createBuffered(handler,listener,o,scope){listener.task=new ExtTouch.util.DelayedTask();return function(){listener.task.delay(o.buffer,handler,scope,ExtTouch.toArray(arguments))}}function createDelayed(handler,listener,o,scope){return function(){var task=new ExtTouch.util.DelayedTask();if(!listener.tasks){listener.tasks=[]}listener.tasks.push(task);task.delay(o.delay||10,handler,scope,ExtTouch.toArray(arguments))}}function createSingle(handler,listener,o,scope){return function(){listener.ev.removeListener(listener.fn,scope);return handler.apply(scope,arguments)}}return{isEvent:true,constructor:function(observable,name){this.name=name;this.observable=observable;this.listeners=[]},addListener:function(fn,scope,options){var me=this,listener;scope=scope||me.observable;if(!me.isListening(fn,scope)){listener=me.createListener(fn,scope,options);if(me.firing){me.listeners=me.listeners.slice(0)}me.listeners.push(listener)}},createListener:function(fn,scope,o){o=o||{};scope=scope||this.observable;var listener={fn:fn,scope:scope,o:o,ev:this},handler=fn;if(o.delay){handler=createDelayed(handler,listener,o,scope)}if(o.buffer){handler=createBuffered(handler,listener,o,scope)}if(o.single){handler=createSingle(handler,listener,o,scope)}listener.fireFn=handler;return listener},findListener:function(fn,scope){var listeners=this.listeners,i=listeners.length,listener,s;while(i--){listener=listeners[i];if(listener){s=listener.scope;if(listener.fn==fn&&(s==scope||s==this.observable)){return i}}}return -1},isListening:function(fn,scope){return this.findListener(fn,scope)!==-1},removeListener:function(fn,scope){var me=this,index,listener,k;index=me.findListener(fn,scope);if(index!=-1){listener=me.listeners[index];if(me.firing){me.listeners=me.listeners.slice(0)}if(listener.task){listener.task.cancel();delete listener.task}k=listener.tasks&&listener.tasks.length;if(k){while(k--){listener.tasks[k].cancel()}delete listener.tasks}me.listeners.splice(index,1);return true}return false},clearListeners:function(){var listeners=this.listeners,i=listeners.length;while(i--){this.removeListener(listeners[i].fn,listeners[i].scope)}},fire:function(){var me=this,listeners=me.listeners,count=listeners.length,i,args,listener;if(count>0){me.firing=true;for(i=0;i<count;i++){listener=listeners[i];args=arguments.length?Array.prototype.slice.call(arguments,0):[];if(listener.o){args.push(listener.o)}if(listener&&listener.fireFn.apply(listener.scope||me.observable,args)===false){return(me.firing=false)}}}me.firing=false;return true}}})());ExtTouch.util.HashMap=ExtTouch.ExtTouchend(ExtTouch.util.Observable,{constructor:function(config){this.addEvents("add","clear","remove","replace");ExtTouch.util.HashMap.superclass.constructor.call(this,config);this.clear(true)},getCount:function(){return this.length},getData:function(key,value){if(value===undefined){value=key;key=this.getKey(value)}return[key,value]},getKey:function(o){return o.id},add:function(key,value){var me=this,data;if(me.containsKey(key)){throw new Error("This key already exists in the HashMap")}data=this.getData(key,value);key=data[0];value=data[1];me.map[key]=value;++me.length;me.fireEvent("add",me,key,value);return value},replace:function(key,value){var me=this,map=me.map,old;if(!me.containsKey(key)){me.add(key,value)}old=map[key];map[key]=value;me.fireEvent("replace",me,key,value,old);return value},remove:function(o){var key=this.findKey(o);if(key!==undefined){return this.removeByKey(key)}return false},removeByKey:function(key){var me=this,value;if(me.containsKey(key)){value=me.map[key];delete me.map[key];--me.length;me.fireEvent("remove",me,key,value);return true}return false},get:function(key){return this.map[key]},clear:function(initial){var me=this;me.map={};me.length=0;if(initial!==true){me.fireEvent("clear",me)}return me},containsKey:function(key){return this.map[key]!==undefined},contains:function(value){return this.containsKey(this.findKey(value))},getKeys:function(){return this.getArray(true)},getValues:function(){return this.getArray(false)},getArray:function(isKey){var arr=[],key,map=this.map;for(key in map){if(map.hasOwnProperty(key)){arr.push(isKey?key:map[key])}}return arr},each:function(fn,scope){var items=ExtTouch.apply({},this.map),key,length=this.length;scope=scope||this;for(key in items){if(items.hasOwnProperty(key)){if(fn.call(scope,key,items[key],length)===false){break}}}return this},clone:function(){var hash=new ExtTouch.util.HashMap(),map=this.map,key;hash.suspendEvents();for(key in map){if(map.hasOwnProperty(key)){hash.add(key,map[key])}}hash.resumeEvents();return hash},findKey:function(value){var key,map=this.map;for(key in map){if(map.hasOwnProperty(key)&&map[key]===value){return key}}return undefined}});ExtTouch.util.Functions={createInterceptor:function(origFn,newFn,scope,returnValue){var method=origFn;if(!ExtTouch.isFunction(newFn)){return origFn}else{return function(){var me=this,args=arguments;newFn.target=me;newFn.method=origFn;return(newFn.apply(scope||me||window,args)!==false)?origFn.apply(me||window,args):returnValue||null}}},createDelegate:function(fn,obj,args,appendArgs){if(!ExtTouch.isFunction(fn)){return fn}return function(){var callArgs=args||arguments;if(appendArgs===true){callArgs=Array.prototype.slice.call(arguments,0);callArgs=callArgs.concat(args)}else{if(ExtTouch.isNumber(appendArgs)){callArgs=Array.prototype.slice.call(arguments,0);var applyArgs=[appendArgs,0].concat(args);Array.prototype.splice.apply(callArgs,applyArgs)}}return fn.apply(obj||window,callArgs)}},defer:function(fn,millis,obj,args,appendArgs){fn=ExtTouch.util.Functions.createDelegate(fn,obj,args,appendArgs);if(millis>0){return setTimeout(fn,millis)}fn();return 0},createSequence:function(origFn,newFn,scope){if(!ExtTouch.isFunction(newFn)){return origFn}else{return function(){var retval=origFn.apply(this||window,arguments);newFn.apply(scope||this||window,arguments);return retval}}}};ExtTouch.defer=ExtTouch.util.Functions.defer;ExtTouch.createInterceptor=ExtTouch.util.Functions.createInterceptor;ExtTouch.createSequence=ExtTouch.util.Functions.createSequence;ExtTouch.createDelegate=ExtTouch.util.Functions.createDelegate;ExtTouch.util.Point=ExtTouch.ExtTouchend(Object,{constructor:function(x,y){this.x=(x!=null&&!isNaN(x))?x:0;this.y=(y!=null&&!isNaN(y))?y:0;return this},copy:function(){return new ExtTouch.util.Point(this.x,this.y)},copyFrom:function(p){this.x=p.x;this.y=p.y;return this},toString:function(){return"Point["+this.x+","+this.y+"]"},equals:function(p){return(this.x==p.x&&this.y==p.y)},isWithin:function(p,threshold){if(!ExtTouch.isObject(threshold)){threshold={x:threshold};threshold.y=threshold.x}return(this.x<=p.x+threshold.x&&this.x>=p.x-threshold.x&&this.y<=p.y+threshold.y&&this.y>=p.y-threshold.y)},translate:function(x,y){if(x!=null&&!isNaN(x)){this.x+=x}if(y!=null&&!isNaN(y)){this.y+=y}},roundedEquals:function(p){return(Math.round(this.x)==Math.round(p.x)&&Math.round(this.y)==Math.round(p.y))}});ExtTouch.util.Point.fromEvent=function(e){var a=(e.changedTouches&&e.changedTouches.length>0)?e.changedTouches[0]:e;return new ExtTouch.util.Point(a.pageX,a.pageY)};ExtTouch.AbstractManager=ExtTouch.ExtTouchend(Object,{typeName:"type",constructor:function(config){ExtTouch.apply(this,config||{});this.all=new ExtTouch.util.HashMap();this.types={}},get:function(id){return this.all.get(id)},register:function(item){this.all.add(item)},unregister:function(item){this.all.remove(item)},registerType:function(type,cls){this.types[type]=cls;cls[this.typeName]=type},isRegistered:function(type){return this.types[type]!==undefined},create:function(config,defaultType){var type=config[this.typeName]||config.type||defaultType,Constructor=this.types[type];if(Constructor==undefined){throw new Error(ExtTouch.util.Format.format("The '{0}' type has not been registered with this manager",type))}return new Constructor(config)},onAvailable:function(id,fn,scope){var all=this.all;all.on("add",function(index,o){if(o.id==id){fn.call(scope||o,o);all.un("add",fn,scope)}})},each:function(fn,scope){this.all.each(fn,scope||this)},getCount:function(){return this.all.getCount()}});ExtTouch.gesture.Manager=new ExtTouch.AbstractManager({eventNames:{start:"touchstart",move:"touchmove",end:"touchend"},clickMoveThreshold:5,init:function(){this.targets=[];this.followTouches=[];this.currentGestures=[];this.currentTargets=[];this.listenerWrappers={start:ExtTouch.createDelegate(this.onTouchStart,this),move:ExtTouch.createDelegate(this.onTouchMove,this),end:ExtTouch.createDelegate(this.onTouchEnd,this),};this.attachListeners()},freeze:function(){this.isFrozen=true},thaw:function(){this.isFrozen=false},getEventSimulator:function(){if(!this.eventSimulator){this.eventSimulator=new ExtTouch.util.EventSimulator()}return this.eventSimulator},attachListeners:function(){ExtTouch.iterate(this.eventNames,function(key,name){document.addEventListener(name,this.listenerWrappers[key],false)},this)},detachListeners:function(){ExtTouch.iterate(this.eventNames,function(key,name){document.removeEventListener(name,this.listenerWrappers[key],false)},this)},onTouchStart:function(e){var targets=[],target=e.target;if(e.stopped===true){return}if(ExtTouch.is.Android){if(!(target.tagName&&["input","tExtToucharea","select"].indexOf(target.tagName.toLowerCase())!==-1)){e.preventDefault()}}if(this.isFrozen){return}if(this.startEvent){this.onTouchEnd(e)}this.locks={};this.currentTargets=[target];while(target){if(this.targets.indexOf(target)!==-1){targets.unshift(target)}target=target.parentNode;this.currentTargets.push(target)}this.startEvent=e;this.startPoint=ExtTouch.util.Point.fromEvent(e);this.lastMovePoint=null;this.isClick=true;this.handleTargets(targets,e)},onTouchMove:function(e){if(ExtTouch.is.MultiTouch){e.preventDefault()}if(!this.startEvent){return}if(ExtTouch.is.Desktop){e.target=this.startEvent.target}if(this.isFrozen){return}var gestures=this.currentGestures,gesture,touch=e.changedTouches?e.changedTouches[0]:e;this.lastMovePoint=ExtTouch.util.Point.fromEvent(e);if(ExtTouch.supports.Touch&&this.isClick&&!this.lastMovePoint.isWithin(this.startPoint,this.clickMoveThreshold)){this.isClick=false}for(var i=0;i<gestures.length;i++){if(e.stopped){break}gesture=gestures[i];if(gesture.listenForMove){gesture.onTouchMove(e,touch)}}},onTouchEnd:function(e){if(ExtTouch.is.Blackberry){e.preventDefault()}if(this.isFrozen){return}var gestures=this.currentGestures.slice(0),ln=gestures.length,i,gesture,endPoint,needsAnotherMove=false,touch=e.changedTouches?e.changedTouches[0]:e;if(this.startPoint){endPoint=ExtTouch.util.Point.fromEvent(e);if(!(this.lastMovePoint||this.startPoint)["equals"](endPoint)){needsAnotherMove=true}}for(i=0;i<ln;i++){gesture=gestures[i];if(!e.stopped&&gesture.listenForEnd){if(needsAnotherMove){gesture.onTouchMove(e,touch)}gesture.onTouchEnd(e,touch)}this.stopGesture(gesture)}if(ExtTouch.supports.Touch&&this.isClick){this.isClick=false}this.lastMovePoint=null;this.followTouches=[];this.startedChangedTouch=false;this.currentTargets=[];this.startEvent=null;this.startPoint=null},handleTargets:function(targets,e){var ln=targets.length,i;this.startedChangedTouch=false;this.startedTouches=ExtTouch.supports.Touch?e.touches:[e];for(i=0;i<ln;i++){if(e.stopped){break}this.handleTarget(targets[i],e,true)}for(i=ln-1;i>=0;i--){if(e.stopped){break}this.handleTarget(targets[i],e,false)}if(this.startedChangedTouch){this.followTouches=this.followTouches.concat((ExtTouch.supports.Touch&&e.targetTouches)?ExtTouch.toArray(e.targetTouches):[e])}},handleTarget:function(target,e,capture){var gestures=ExtTouch.Element.data(target,"x-gestures")||[],ln=gestures.length,i,gesture;for(i=0;i<ln;i++){gesture=gestures[i];if((!!gesture.capture===!!capture)&&(this.followTouches.length<gesture.touches)&&((ExtTouch.supports.Touch&&e.targetTouches)?(e.targetTouches.length===gesture.touches):true)){this.startedChangedTouch=true;this.startGesture(gesture);if(gesture.listenForStart){gesture.onTouchStart(e,e.changedTouches?e.changedTouches[0]:e)}if(e.stopped){break}}}},startGesture:function(gesture){gesture.started=true;this.currentGestures.push(gesture)},stopGesture:function(gesture){gesture.started=false;this.currentGestures.remove(gesture)},addEventListener:function(target,eventName,listener,options){target=ExtTouch.getDom(target);options=options||{};var targets=this.targets,name=this.getGestureName(eventName),gestures=ExtTouch.Element.data(target,"x-gestures"),gesture;if(!gestures){gestures=[];ExtTouch.Element.data(target,"x-gestures",gestures)}if(!name){throw new Error("Trying to subscribe to unknown event "+eventName)}if(targets.indexOf(target)===-1){this.targets.push(target)}gesture=this.get(target.id+"-"+name);if(!gesture){gesture=this.create(ExtTouch.apply({},options,{target:target,type:name}));gestures.push(gesture)}gesture.addListener(eventName,listener);if(this.startedChangedTouch&&this.currentTargets.contains(target)&&!gesture.started&&!options.subsequent){this.startGesture(gesture);if(gesture.listenForStart){gesture.onTouchStart(this.startEvent,this.startedTouches[0])}}},removeEventListener:function(target,eventName,listener){target=ExtTouch.getDom(target);var name=this.getGestureName(eventName),gestures=ExtTouch.Element.data(target,"x-gestures")||[],gesture;gesture=this.get(target.id+"-"+name);if(gesture){gesture.removeListener(eventName,listener);for(name in gesture.listeners){return}gesture.destroy();gestures.remove(gesture);ExtTouch.Element.data(target,"x-gestures",gestures)}},getGestureName:function(ename){return this.names&&this.names[ename]},registerType:function(type,cls){var handles=cls.prototype.handles,i,ln;this.types[type]=cls;cls[this.typeName]=type;if(!handles){handles=cls.prototype.handles=[type]}this.names=this.names||{};for(i=0,ln=handles.length;i<ln;i++){this.names[handles[i]]=type}}});ExtTouch.regGesture=function(){return ExtTouch.gesture.Manager.registerType.apply(ExtTouch.gesture.Manager,arguments)};ExtTouch.TouchEventObjectImpl=ExtTouch.ExtTouchend(Object,{constructor:function(e,args){if(e){this.setEvent(e,args)}},setEvent:function(e,args){ExtTouch.apply(this,{event:e,time:e.timeStamp});this.touches=e.touches||[e];this.changedTouches=e.changedTouches||[e];this.targetTouches=e.targetTouches||[e];if(args){this.target=args.target;ExtTouch.apply(this,args)}else{this.target=e.target}return this},stopEvent:function(){this.stopPropagation();this.preventDefault()},stopPropagation:function(){this.event.stopped=true},preventDefault:function(){this.event.preventDefault()},getTarget:function(selector,maxDepth,returnEl){if(selector){return ExtTouch.fly(this.target).findParent(selector,maxDepth,returnEl)}else{return returnEl?ExtTouch.get(this.target):this.target}}});ExtTouch.TouchEventObject=new ExtTouch.TouchEventObjectImpl();ExtTouch.gesture.Gesture=ExtTouch.ExtTouchend(Object,{listenForStart:true,listenForEnd:true,listenForMove:true,disableLocking:false,touches:1,constructor:function(config){config=config||{};ExtTouch.apply(this,config);this.target=ExtTouch.getDom(this.target);this.listeners={};if(!this.target){throw new Error("Trying to bind a "+this.type+" event to element that does'nt exist: "+this.target)}this.id=this.target.id+"-"+this.type;ExtTouch.gesture.Gesture.superclass.constructor.call(this);ExtTouch.gesture.Manager.register(this)},addListener:function(name,listener){this.listeners[name]=this.listeners[name]||[];this.listeners[name].push(listener)},removeListener:function(name,listener){var listeners=this.listeners[name];if(listeners){listeners.remove(listener);if(listeners.length==0){delete this.listeners[name]}for(name in this.listeners){if(this.listeners.hasOwnProperty(name)){return}}this.listeners={}}},fire:function(type,e,args){var listeners=this.listeners&&this.listeners[type],ln=listeners&&listeners.length,i;if(!this.disableLocking&&this.isLocked(type)){return false}if(ln){args=ExtTouch.apply(args||{},{time:e.timeStamp,type:type,gesture:this,target:(e.target.nodeType==3)?e.target.parentNode:e.target});for(i=0;i<ln;i++){listeners[i](e,args)}}return true},stop:function(){ExtTouch.gesture.Manager.stopGesture(this)},lock:function(){if(!this.disableLocking){var args=arguments,ln=args.length,i;for(i=0;i<ln;i++){ExtTouch.gesture.Manager.locks[args[i]]=this.id}}},unlock:function(){if(!this.disableLocking){var args=arguments,ln=args.length,i;for(i=0;i<ln;i++){if(ExtTouch.gesture.Manager.locks[args[i]]==this.id){delete ExtTouch.gesture.Manager.locks[args[i]]}}}},isLocked:function(type){var lock=ExtTouch.gesture.Manager.locks[type];return !!(lock&&lock!==this.id)},getLockingGesture:function(type){var lock=ExtTouch.gesture.Manager.locks[type];if(lock){return ExtTouch.gesture.Manager.get(lock)||null}return null},onTouchStart:ExtTouch.emptyFn,onTouchMove:ExtTouch.emptyFn,onTouchEnd:ExtTouch.emptyFn,destroy:function(){this.stop();this.listeners=null;ExtTouch.gesture.Manager.unregister(this)}});ExtTouch.gesture.Touch=ExtTouch.ExtTouchend(ExtTouch.gesture.Gesture,{handles:["touchstart","touchmove","touchend","touchdown"],touchDownInterval:500,onTouchStart:function(e,touch){this.startX=this.previousX=touch.pageX;this.startY=this.previousY=touch.pageY;this.startTime=this.previousTime=e.timeStamp;this.fire("touchstart",e);this.lastEvent=e;if(this.listeners&&this.listeners.touchdown){this.touchDownIntervalId=setInterval(ExtTouch.createDelegate(this.touchDownHandler,this),this.touchDownInterval)}},onTouchMove:function(e,touch){this.fire("touchmove",e,this.getInfo(touch));this.lastEvent=e},onTouchEnd:function(e){this.fire("touchend",e,this.lastInfo);clearInterval(this.touchDownIntervalId)},touchDownHandler:function(){this.fire("touchdown",this.lastEvent,this.lastInfo)},getInfo:function(touch){var time=Date.now(),deltaX=touch.pageX-this.startX,deltaY=touch.pageY-this.startY,info={startX:this.startX,startY:this.startY,previousX:this.previousX,previousY:this.previousY,pageX:touch.pageX,pageY:touch.pageY,deltaX:deltaX,deltaY:deltaY,absDeltaX:Math.abs(deltaX),absDeltaY:Math.abs(deltaY),previousDeltaX:touch.pageX-this.previousX,previousDeltaY:touch.pageY-this.previousY,time:time,startTime:this.startTime,previousTime:this.previousTime,deltaTime:time-this.startTime,previousDeltaTime:time-this.previousTime};this.previousTime=info.time;this.previousX=info.pageX;this.previousY=info.pageY;this.lastInfo=info;return info}});ExtTouch.regGesture("touch",ExtTouch.gesture.Touch);ExtTouch.gesture.Swipe=ExtTouch.ExtTouchend(ExtTouch.gesture.Gesture,{listenForEnd:false,swipeThreshold:35,swipeTime:1000,onTouchStart:function(e,touch){this.startTime=e.timeStamp;this.startX=touch.pageX;this.startY=touch.pageY;this.lock("scroll","scrollstart","scrollend")},onTouchMove:function(e,touch){var deltaY=touch.pageY-this.startY,deltaX=touch.pageX-this.startX,absDeltaY=Math.abs(deltaY),absDeltaX=Math.abs(deltaX),deltaTime=e.timeStamp-this.startTime;if(absDeltaY-absDeltaX>3||deltaTime>this.swipeTime){this.unlock("drag","dragstart","dragend");this.stop()}else{if(absDeltaX>this.swipeThreshold&&absDeltaX>absDeltaY){this.fire("swipe",e,{direction:(deltaX<0)?"left":"right",distance:absDeltaX,deltaTime:deltaTime,deltaX:deltaX});this.stop()}}}});ExtTouch.regGesture("swipe",ExtTouch.gesture.Swipe);ExtTouch.gesture.Tap=ExtTouch.ExtTouchend(ExtTouch.gesture.Gesture,{handles:["tapstart","tapcancel","tap","doubletap","taphold","singletap"],cancelThreshold:10,doubleTapThreshold:800,singleTapThreshold:400,holdThreshold:1000,fireClickEvent:false,onTouchStart:function(e,touch){var me=this;me.startX=touch.pageX;me.startY=touch.pageY;me.fire("tapstart",e,me.getInfo(touch));if(this.listeners.taphold){me.timeout=setTimeout(function(){me.fire("taphold",e,me.getInfo(touch));delete me.timeout},me.holdThreshold)}me.lastTouch=touch},onTouchMove:function(e,touch){var me=this;if(me.isCancel(touch)){me.fire("tapcancel",e,me.getInfo(touch));if(me.timeout){clearTimeout(me.timeout);delete me.timeout}me.stop()}me.lastTouch=touch},onTouchEnd:function(e){var me=this,info=me.getInfo(me.lastTouch);this.fireTapEvent(e,info);if(me.lastTapTime&&e.timeStamp-me.lastTapTime<=me.doubleTapThreshold){me.lastTapTime=null;e.preventDefault();me.fire("doubletap",e,info)}else{me.lastTapTime=e.timeStamp}if(me.listeners&&me.listeners.singletap&&me.singleTapThreshold&&!me.preventSingleTap){me.fire("singletap",e,info);me.preventSingleTap=true;setTimeout(function(){me.preventSingleTap=false},me.singleTapThreshold)}if(me.timeout){clearTimeout(me.timeout);delete me.timeout}},fireTapEvent:function(e,info){this.fire("tap",e,info);if(e.event){e=e.event}var target=(e.changedTouches?e.changedTouches[0]:e).target;if(!target.disabled&&this.fireClickEvent){var clickEvent=document.createEvent("MouseEvent");clickEvent.initMouseEvent("click",e.bubbles,e.cancelable,document.defaultView,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.metaKey,e.button,e.relatedTarget);clickEvent.isSimulated=true;target.dispatchEvent(clickEvent)}},getInfo:function(touch){var x=touch.pageX,y=touch.pageY;return{pageX:x,pageY:y,startX:x,startY:y}},isCancel:function(touch){var me=this;return(Math.abs(touch.pageX-me.startX)>=me.cancelThreshold||Math.abs(touch.pageY-me.startY)>=me.cancelThreshold)}});ExtTouch.regGesture("tap",ExtTouch.gesture.Tap);ExtTouch.gesture.Pinch=ExtTouch.ExtTouchend(ExtTouch.gesture.Gesture,{handles:["pinchstart","pinch","pinchend"],touches:2,onTouchStart:function(e){var me=this;if(this.isMultiTouch(e)){me.lock("swipe","scroll","scrollstart","scrollend","touchmove","touchend","touchstart","tap","tapstart","taphold","tapcancel","doubletap");me.pinching=true;var targetTouches=e.targetTouches;me.startFirstTouch=targetTouches[0];me.startSecondTouch=targetTouches[1];me.previousDistance=me.startDistance=me.getDistance(me.startFirstTouch,me.startSecondTouch);me.previousScale=1;me.fire("pinchstart",e,{distance:me.startDistance,scale:me.previousScale})}else{if(me.pinching){me.unlock("swipe","scroll","scrollstart","scrollend","touchmove","touchend","touchstart","tap","tapstart","taphold","tapcancel","doubletap");me.pinching=false}}},isMultiTouch:function(e){return e&&ExtTouch.supports.Touch&&e.targetTouches&&e.targetTouches.length>1},onTouchMove:function(e){if(!this.isMultiTouch(e)){this.onTouchEnd(e);return}if(this.pinching){this.fire("pinch",e,this.getPinchInfo(e))}},onTouchEnd:function(e){if(this.pinching){this.fire("pinchend",e)}},getPinchInfo:function(e){var me=this,targetTouches=e.targetTouches,firstTouch=targetTouches[0],secondTouch=targetTouches[1],distance=me.getDistance(firstTouch,secondTouch),scale=distance/me.startDistance,info={scale:scale,deltaScale:scale-1,previousScale:me.previousScale,previousDeltaScale:scale-me.previousScale,distance:distance,deltaDistance:distance-me.startDistance,startDistance:me.startDistance,previousDistance:me.previousDistance,previousDeltaDistance:distance-me.previousDistance,firstTouch:firstTouch,secondTouch:secondTouch,firstPageX:firstTouch.pageX,firstPageY:firstTouch.pageY,secondPageX:secondTouch.pageX,secondPageY:secondTouch.pageY,midPointX:(firstTouch.pageX+secondTouch.pageX)/2,midPointY:(firstTouch.pageY+secondTouch.pageY)/2};me.previousScale=scale;me.previousDistance=distance;return info},getDistance:function(firstTouch,secondTouch){return Math.sqrt(Math.pow(Math.abs(firstTouch.pageX-secondTouch.pageX),2)+Math.pow(Math.abs(firstTouch.pageY-secondTouch.pageY),2))}});ExtTouch.regGesture("pinch",ExtTouch.gesture.Pinch);